{
	"name": "DimAirPollutionSQL",
	"properties": {
		"content": {
			"query": "\nCREATE EXTERNAL TABLE ExternalAirPollution (\n    lon FLOAT,\n    lat FLOAT,\n    aqi INT,\n    co FLOAT,\n    no FLOAT,\n    no2 FLOAT,\n    o3 FLOAT,\n    so2 FLOAT,\n    pm2_5 FLOAT,\n    pm10 FLOAT,                         -- Particulate matter 10 level\n    nh3 FLOAT,                          -- Ammonia level\n    timestamp INT,                      -- Original timestamp (integer)\n    corrected_timestamp INT,            -- Corrected timestamp (integer)\n    location NVARCHAR(100),             -- Location as a string\n    date_time DATETIME2,                -- Date and time with timestamp precision\n    id NVARCHAR(100),                   -- String identifier\n    o3_8hr FLOAT,                       -- Ozone level (8-hour average)\n    o3_1hr FLOAT,                       -- Ozone level (1-hour average)\n    pm2_5_24hr FLOAT,                   -- PM2.5 level (24-hour average)\n    co_8hr FLOAT,                       -- CO level (8-hour average)\n    pm10_24hr FLOAT,                    -- PM10 level (24-hour average)\n    so2_1hr FLOAT,                      -- SO2 level (1-hour average)\n    so2_24hr FLOAT,                     -- SO2 level (24-hour average)\n    no2_1hr FLOAT,                      -- NO2 level (1-hour average)\n    us_aqi INT                          -- U.S. Air Quality Index (integer)\n)\nWITH (\n    LOCATION = 'gold/processed_weather/part-00000-d801ff3d-1222-4629-8da2-fa8f332dcffc-c000.snappy.parquet', --may be different based on your storage location\n    DATA_SOURCE = MyDataSource,\n    FILE_FORMAT = ParquetFileFormat\n);\n\n-- Create FactWeather table with matching data types (internal sql table)\nCREATE TABLE FactWeather (\n    clouds_all SMALLINT,\n    feels_like_K FLOAT,\n    humidity SMALLINT,\n    pressure SMALLINT,\n    temp_K FLOAT,\n    temp_max_K FLOAT,\n    temp_min_K FLOAT,\n    wind_deg SMALLINT,\n    wind_gust FLOAT,\n    wind_speed FLOAT,\n    corrected_timestamp INT,\n    location NVARCHAR(100),\n    date_time DATETIME2,\n    id NVARCHAR(100),\n    temp_C FLOAT,\n    temp_min_C FLOAT,\n    temp_max_C FLOAT,\n    feels_like_C FLOAT,\n    temp_F FLOAT,\n    temp_min_F FLOAT,\n    temp_max_F FLOAT,\n    feels_like_F FLOAT,\n    lon FLOAT,\n    lat FLOAT,\n    weather_combined_value NVARCHAR(100),\n    date DATE\n);\nINSERT INTO FactWeather (\n    clouds_all,\n    feels_like_K,\n    humidity,\n    pressure,\n    temp_K,\n    temp_max_K,\n    temp_min_K,\n    wind_deg,\n    wind_gust,\n    wind_speed,\n    corrected_timestamp,\n    location,\n    date_time,\n    id,\n    temp_C,\n    temp_min_C,\n    temp_max_C,\n    feels_like_C,\n    temp_F,\n    temp_min_F,\n    temp_max_F,\n    feels_like_F,\n    lon,\n    lat,\n    weather_combined_value,\n    date\n)\nSELECT \n    clouds_all,\n    feels_like_K,\n    humidity,\n    pressure,\n    temp_K,\n    temp_max_K,\n    temp_min_K,\n    wind_deg,\n    wind_gust,\n    wind_speed,\n    corrected_timestamp,\n    location,\n    CAST(date_time AS DATETIME2) AS date_time,\n    id,\n    temp_C,\n    temp_min_C,\n    temp_max_C,\n    feels_like_C,\n    temp_F,\n    temp_min_F,\n    temp_max_F,\n    feels_like_F,\n    lon,\n    lat,\n    CONCAT(weather_id_value, '_', weather_icon_value) AS weather_combined_value, \n    CAST(date_time AS DATE) AS date\nFROM ExternalWeather;\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "ds598anthonyhuangsqlpool",
				"poolName": "ds598anthonyhuangsqlpool"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}